!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("core-js/modules/es.regexp.to-string"),require("core-js/modules/web.dom-collections.iterator")):"function"==typeof define&&define.amd?define(["core-js/modules/es.regexp.to-string","core-js/modules/web.dom-collections.iterator"],e):(t=t||self).MObserver=e()}(this,(function(){"use strict";function t(t,e){var r=e.get(t);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(t):r.value}function e(t,e,r){var i=e.get(t);if(!i)throw new TypeError("attempted to set private field on non-instance");if(i.set)i.set.call(t,r);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=r}return r}function r(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}var i=new WeakMap,n=new WeakMap,s=new WeakMap,l=new WeakMap,a=new WeakMap,o=new WeakSet,u=new WeakSet;var h=function(){return{attributes:!0,attributeOldValue:!0,childList:!0,subtree:!0,characterData:!0,characterDataOldValue:!0}},c=function(){return"".concat(this.prefix,"Mobserver")},d=function(e,r,n){let s=this.getCacheKey(e),l=new MutationObserver(r||function(t){console.log(t)}),a=t(this,i).get(s)||{};return a[n=n||this.uuid()]=l,t(this,i).set(s,a),{name:n,observer:l}},f=function(t,e,i,n){t=this.selector(t);let s=r(this,o,d).call(this,t,e,n);return s.observer.observe(t,i),s};return class{constructor(t){u.add(this),o.add(this),a.set(this,{get:c,set:void 0}),l.set(this,{get:h,set:void 0}),i.set(this,{writable:!0,value:void 0}),n.set(this,{writable:!0,value:void 0}),s.set(this,{writable:!0,value:"zc"}),e(this,i,new Map),this.prefix=t}get prefix(){return t(this,s)}set prefix(t){e(this,s,"string"==typeof t&&t.length?t:"zc")}uuid(){return[Math.random().toString(16).slice(2),(new Date).getTime().toString(16),Math.random().toString(16).slice(2)].join("").slice(2,34)}selector(t){if("string"==typeof t&&(t=document.querySelector(t)),!(t&&t instanceof HTMLElement))throw new Error("无效的 target！");return t}getCacheKey(e){let r=(e=this.selector(e)).dataset[t(this,a)];return r||(r=this.uuid(),e.dataset[t(this,a)]=r),r}observe(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return i=i||{},r(this,u,f).call(this,t,e,i,n)}observeAll(e,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=t(this,l);return Array.isArray(n)&&n.length&&(a.attributeFilter=n),r(this,u,f).call(this,e,i,a,s)}attribute(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return r(this,u,f).call(this,t,e,{attributes:!0,attributeOldValue:!0},i)}attributeChild(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return r(this,u,f).call(this,t,e,{subtree:!0,attributes:!0,attributeOldValue:!0},i)}attributeFilter(t,e,i,n){let s={attributes:!0,attributeFilter:i,attributeOldValue:!0};return r(this,u,f).call(this,t,e,s,n)}attributeFilterChild(t,e,i,n){let s={subtree:!0,attributes:!0,attributeFilter:i,attributeOldValue:!0};return r(this,u,f).call(this,t,e,s,n)}node(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return r(this,u,f).call(this,t,e,{childList:!0},i)}nodeChild(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return r(this,u,f).call(this,t,e,{subtree:!0,childList:!0},i)}character(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return r(this,u,f).call(this,t,e,{subtree:!0,characterData:!0,characterDataOldValue:!0},i)}disconnect(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.getCacheKey(e),s=t(this,i).get(n);if(s){if(null===r)return Object.values(s).forEach(t=>{t.disconnect()}),!0;if(r&&s[r])return s[r].disconnect(),!0}return!1}takeRecords(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.getCacheKey(e),s=t(this,i).get(n),l={};if(s){if(null===r)for(let t in s)l[t]=s[t].takeRecords();r&&s[r]&&(l[r]=s[r].takeRecords())}return l}remove(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.getCacheKey(e),s=t(this,i).get(n);if(s){if(null===r){for(let t in s)s[t].disconnect(),s[t]=null;return t(this,i).delete(n),!0}if(s[r])return s[r].disconnect(),s[r]=null,delete s[r],t(this,i).set(n,s),!0}}clear(){return t(this,i).forEach((function(t){for(let e in t)t[e].disconnect(),t[e]=null})),t(this,i).clear(),!0}}}));
