!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("core-js/modules/es.regexp.to-string"),require("core-js/modules/web.dom-collections.iterator")):"function"==typeof define&&define.amd?define(["core-js/modules/es.regexp.to-string","core-js/modules/web.dom-collections.iterator"],t):(e=e||self).MObserver=t()}(this,(function(){"use strict";function e(e,t){var r=t.get(e);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(e):r.value}function t(e,t,r){var i=t.get(e);if(!i)throw new TypeError("attempted to set private field on non-instance");if(i.set)i.set.call(e,r);else{if(!i.writable)throw new TypeError("attempted to set read only private field");i.value=r}return r}function r(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var i=new WeakMap,n=new WeakMap,s=new WeakMap,l=new WeakSet;var o=function(){return{attributes:!0,attributeOldValue:!0,childList:!0,subtree:!0,characterData:!0,characterDataOldValue:!0}},a=function(t,r,n,s){t=this.selector(t),r=r||function(e){console.log(e)},s=s||this.uuid();let l=new MutationObserver(r);l.observe(t,n);let o=this.getCacheKey(t),a=e(this,i).get(o)||{};return a[s]&&(a[s].observer.disconnect(),a[s].observer=null),a[s]={config:n,observer:l},e(this,i).set(o,a),{name:s,observer:l}};return class{constructor(e){l.add(this),s.set(this,{get:o,set:void 0}),i.set(this,{writable:!0,value:void 0}),n.set(this,{writable:!0,value:"zc"}),t(this,i,new Map),this.prefix=e}get prefix(){return e(this,n)}set prefix(e){t(this,n,"string"==typeof e&&e.length?e:"zc")}uuid(){return[Math.random().toString(16).slice(2),(new Date).getTime().toString(16),Math.random().toString(16).slice(2)].join("").slice(2,34)}selector(e){if("string"==typeof e&&(e=document.querySelector(e)),!(e&&e instanceof HTMLElement))throw new Error("无效的 target！");return e}getCacheKey(e){e=this.selector(e);let t="".concat(this.prefix,"Mobserver"),r=e.dataset[t];return r||(r=this.uuid(),e.dataset[t]=r),r}observe(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return i=i||{},r(this,l,a).call(this,e,t,i,n)}observeAll(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",u=e(this,s);return Array.isArray(n)&&n.length&&(u.attributeFilter=n),r(this,l,a).call(this,t,i,u,o)}attribute(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return r(this,l,a).call(this,e,t,{attributes:!0,attributeOldValue:!0},i)}attributeChild(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return r(this,l,a).call(this,e,t,{subtree:!0,attributes:!0,attributeOldValue:!0},i)}attributeFilter(e,t,i,n){let s={attributes:!0,attributeFilter:i,attributeOldValue:!0};return r(this,l,a).call(this,e,t,s,n)}attributeFilterChild(e,t,i,n){let s={subtree:!0,attributes:!0,attributeFilter:i,attributeOldValue:!0};return r(this,l,a).call(this,e,t,s,n)}node(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return r(this,l,a).call(this,e,t,{childList:!0},i)}nodeChild(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return r(this,l,a).call(this,e,t,{subtree:!0,childList:!0},i)}character(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return r(this,l,a).call(this,e,t,{subtree:!0,characterData:!0,characterDataOldValue:!0},i)}disconnect(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getCacheKey(t),s=e(this,i).get(n);if(s){if(null===r)return Object.values(s).forEach(e=>{e.observer.disconnect()}),!0;if(r&&s[r])return s[r].observer.disconnect(),!0}return!1}reconnect(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getCacheKey(t),s=e(this,i).get(n);if(s){if(t=this.selector(t),null===r)return Object.values(s).forEach(e=>{e.observer.observe(t,e.config)}),!0;if(r&&s[r])return s[r].observer.observe(t,s[r].config),!0}return!1}takeRecords(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.getCacheKey(t),s=e(this,i).get(n),l={};if(s){if(null===r)for(let e in s)l[e]=s[e].observer.takeRecords();r&&s[r]&&(l[r]=s[r].observer.takeRecords())}return l}remove(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.getCacheKey(t),s=e(this,i).get(n);if(s){if(null===r){for(let e in s)s[e].observer.disconnect(),s[e].observer=null;return e(this,i).delete(n),!0}if(s[r])return s[r].observer.disconnect(),s[r].observer=null,delete s[r],e(this,i).set(n,s),!0}}clear(){return e(this,i).forEach((function(e){for(let t in e)e[t].observer.disconnect(),e[t].observer=null})),e(this,i).clear(),!0}}}));
